<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Kokteyl Gecesi</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display&family=DM+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #0b0b10;
    --card: #13131a;
    --card-hover: #1a1a23;
    --gold: #d4a843;
    --gold-light: #f0d78c;
    --gold-dim: #8a7234;
    --cream: #eae5da;
    --cream-mid: #b5ad9e;
    --cream-dim: #7a7468;
    --wine: #7a2038;
    --green: #4ade80;
    --red: #ef5555;
    --glow: rgba(212, 168, 67, 0.10);
    --border: rgba(212, 168, 67, 0.07);
    --border-h: rgba(212, 168, 67, 0.20);
    --border-s: rgba(212, 168, 67, 0.50);
  }

  * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

  html { font-size: 16px; }

  body {
    background: var(--bg);
    color: var(--cream);
    font-family: 'DM Sans', -apple-system, BlinkMacSystemFont, sans-serif;
    font-weight: 400;
    min-height: 100vh;
    min-height: 100dvh;
    overflow-x: hidden;
    -webkit-font-smoothing: antialiased;
    line-height: 1.5;
  }

  /* Subtle grain */
  body::after {
    content: '';
    position: fixed;
    inset: 0;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 512 512' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.75' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.03'/%3E%3C/svg%3E");
    pointer-events: none;
    z-index: 100;
  }

  .ambient { position: fixed; border-radius: 50%; filter: blur(160px); pointer-events: none; z-index: 0; }
  .amb-1 { width: 420px; height: 420px; top: -160px; left: -100px; background: var(--gold); opacity: 0.04; }
  .amb-2 { width: 350px; height: 350px; bottom: -120px; right: -60px; background: var(--wine); opacity: 0.05; }

  .page {
    position: relative; z-index: 1;
    width: 100%;
    max-width: 440px;
    margin: 0 auto;
    padding: 32px 16px 100px;
  }

  /* â”€â”€â”€ TYPOGRAPHY â”€â”€â”€ */
  .title {
    font-family: 'DM Serif Display', serif;
    color: var(--gold);
    font-weight: 400;
  }

  /* â”€â”€â”€ LOGIN â”€â”€â”€ */
  .login-screen {
    min-height: 100vh;
    min-height: 100dvh;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 24px 16px;
  }

  .login-box {
    width: 100%;
    max-width: 360px;
    text-align: center;
    animation: fadeIn 0.8s ease;
  }

  .login-icon { font-size: 44px; margin-bottom: 16px; display: block; }

  .login-box h1 {
    font-family: 'DM Serif Display', serif;
    font-size: 26px;
    color: var(--gold);
    margin-bottom: 6px;
  }

  .login-box .subtitle {
    font-size: 15px;
    color: var(--cream-dim);
    margin-bottom: 32px;
    line-height: 1.5;
  }

  .password-input {
    width: 100%;
    padding: 16px;
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 12px;
    color: var(--cream);
    font-family: 'DM Sans', sans-serif;
    font-size: 20px;
    font-weight: 600;
    letter-spacing: 5px;
    text-align: center;
    text-transform: uppercase;
    outline: none;
    transition: border-color 0.3s;
    margin-bottom: 14px;
  }
  .password-input::placeholder {
    letter-spacing: 1px;
    font-size: 15px;
    font-weight: 400;
    color: var(--cream-dim);
    opacity: 0.6;
  }
  .password-input:focus { border-color: var(--gold-dim); }

  .btn-gold {
    width: 100%;
    padding: 16px;
    background: linear-gradient(135deg, var(--gold-dim), var(--gold));
    border: none;
    border-radius: 12px;
    color: var(--bg);
    font-family: 'DM Sans', sans-serif;
    font-size: 15px;
    font-weight: 700;
    letter-spacing: 0.5px;
    cursor: pointer;
    transition: all 0.2s;
    min-height: 52px;
  }
  .btn-gold:active { transform: scale(0.98); opacity: 0.9; }

  .login-error {
    margin-top: 14px;
    font-size: 14px;
    color: var(--red);
    opacity: 0;
    transition: opacity 0.3s;
  }
  .login-error.show { opacity: 1; }

  /* â”€â”€â”€ VOTE â”€â”€â”€ */
  .vote-screen { display: none; }

  .header {
    text-align: center;
    margin-bottom: 28px;
    animation: fadeDown 0.7s ease;
  }

  .header-icon { font-size: 32px; margin-bottom: 8px; display: block; }

  .greeting-banner {
    font-size: 15px;
    font-weight: 500;
    color: var(--gold-light);
    margin-bottom: 14px;
    padding: 10px 16px;
    background: rgba(212, 168, 67, 0.06);
    border: 1px solid rgba(212, 168, 67, 0.12);
    border-radius: 10px;
    animation: fadeIn 0.8s ease 0.2s both;
  }

  .header h1 { font-size: 24px; line-height: 1.3; }
  .header p { font-size: 15px; color: var(--cream-mid); margin-top: 8px; line-height: 1.55; }

  .rule-badges {
    display: flex;
    flex-direction: column;
    gap: 8px;
    margin-top: 14px;
    align-items: center;
  }

  .rule-badge {
    display: inline-block;
    padding: 8px 16px;
    border: 1px solid var(--gold-dim);
    border-radius: 100px;
    font-size: 13px;
    color: var(--gold-light);
    font-weight: 500;
  }

  .hint-badge {
    display: inline-block;
    padding: 8px 16px;
    border: 1px dashed var(--gold-dim);
    border-radius: 100px;
    font-size: 13px;
    color: var(--gold);
    font-weight: 400;
    animation: pulse 2s ease-in-out infinite;
  }

  @keyframes pulse {
    0%, 100% { opacity: 0.7; }
    50% { opacity: 1; }
  }

  .counter {
    text-align: center;
    margin-bottom: 20px;
    font-size: 15px;
    color: var(--cream-dim);
    font-weight: 400;
  }
  .counter .num { color: var(--gold); font-weight: 700; font-size: 20px; }
  .counter.done .num { color: var(--green); }

  /* â”€â”€â”€ CARDS â”€â”€â”€ */
  .card {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 14px;
    padding: 20px;
    margin-bottom: 12px;
    cursor: pointer;
    transition: all 0.25s ease;
    position: relative;
    animation: fadeUp 0.5s ease both;
    min-height: 48px;
  }
  .card:nth-child(1) { animation-delay: 0.05s; }
  .card:nth-child(2) { animation-delay: 0.10s; }
  .card:nth-child(3) { animation-delay: 0.15s; }
  .card:nth-child(4) { animation-delay: 0.20s; }
  .card:nth-child(5) { animation-delay: 0.25s; }

  .card:active { transform: scale(0.98); }

  .card.selected {
    border-color: var(--border-s);
    background: linear-gradient(160deg, var(--card) 50%, rgba(212, 168, 67, 0.04) 100%);
    box-shadow: 0 0 40px var(--glow);
  }

  .card.disabled { opacity: 0.25; pointer-events: none; }

  .check {
    position: absolute;
    top: 16px; right: 16px;
    width: 28px; height: 28px;
    border-radius: 50%;
    border: 2px solid rgba(212, 168, 67, 0.15);
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.25s;
    flex-shrink: 0;
  }
  .selected .check { background: var(--gold); border-color: var(--gold); }
  .check svg { width: 14px; height: 14px; stroke: var(--bg); stroke-width: 3; fill: none; opacity: 0; transition: opacity 0.2s; }
  .selected .check svg { opacity: 1; }

  .card-name {
    font-family: 'DM Serif Display', serif;
    font-size: 21px;
    color: var(--gold-light);
    margin-bottom: 3px;
    padding-right: 44px;
    line-height: 1.3;
  }

  .card-vibe {
    font-size: 12px;
    color: var(--cream-dim);
    text-transform: uppercase;
    letter-spacing: 1.2px;
    font-weight: 600;
    margin-bottom: 12px;
  }

  .ingredients { display: flex; flex-wrap: wrap; gap: 6px; margin-bottom: 8px; }
  .ing-tag {
    padding: 6px 12px;
    background: rgba(255,255,255,0.04);
    border: 1px solid rgba(255,255,255,0.07);
    border-radius: 100px;
    font-size: 13px;
    color: var(--cream);
    font-weight: 400;
  }

  .surprise-tags { display: flex; gap: 6px; flex-wrap: wrap; }
  .surprise-tag {
    padding: 6px 12px;
    background: rgba(212, 168, 67, 0.06);
    border: 1px dashed var(--gold-dim);
    border-radius: 100px;
    font-size: 13px;
    color: var(--gold);
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s;
    min-height: 34px;
    display: flex;
    align-items: center;
  }
  .surprise-tag:active { background: rgba(212, 168, 67, 0.15); }
  .surprise-tag.revealed { border-style: solid; background: rgba(212, 168, 67, 0.1); cursor: default; }

  .garnish {
    margin-top: 10px;
    font-size: 13px;
    color: var(--cream-dim);
    font-style: italic;
    opacity: 0.6;
  }

  /* â”€â”€â”€ SUBMIT â”€â”€â”€ */
  .submit-wrap { margin-top: 28px; animation: fadeUp 0.5s ease 0.4s both; }

  .submit-btn {
    width: 100%;
    padding: 18px;
    background: linear-gradient(135deg, var(--gold-dim) 0%, var(--gold) 100%);
    border: none;
    border-radius: 14px;
    color: var(--bg);
    font-family: 'DM Sans', sans-serif;
    font-size: 16px;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.2s;
    opacity: 0.25;
    pointer-events: none;
    min-height: 56px;
  }
  .submit-btn.active { opacity: 1; pointer-events: auto; }
  .submit-btn.active:active { transform: scale(0.98); }
  .submit-btn.sending { opacity: 0.5; pointer-events: none; }

  /* â”€â”€â”€ SUCCESS â”€â”€â”€ */
  .success-screen {
    display: none;
    min-height: 100vh;
    min-height: 100dvh;
    align-items: center;
    justify-content: center;
    text-align: center;
    padding: 24px 16px;
  }

  .success-screen .icon { font-size: 56px; margin-bottom: 16px; display: block; animation: popIn 0.5s ease; }
  .success-screen h1 { font-family: 'DM Serif Display', serif; font-size: 26px; color: var(--gold); margin-bottom: 10px; }
  .success-screen p { font-size: 15px; color: var(--cream-mid); line-height: 1.6; }

  .chosen-list { margin-top: 20px; text-align: left; max-width: 280px; margin-left: auto; margin-right: auto; }
  .chosen-item {
    padding: 12px 16px;
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 10px;
    margin-bottom: 8px;
    font-family: 'DM Serif Display', serif;
    font-size: 17px;
    color: var(--gold-light);
  }

  /* â”€â”€â”€ QUIZ MODAL â”€â”€â”€ */
  .modal-overlay {
    display: none;
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.85);
    z-index: 50;
    align-items: center;
    justify-content: center;
    padding: 16px;
  }
  .modal-overlay.show { display: flex; }

  .modal {
    background: var(--card);
    border: 1px solid var(--border-h);
    border-radius: 16px;
    padding: 24px 20px;
    max-width: 360px;
    width: 100%;
    text-align: center;
    animation: fadeUp 0.3s ease;
  }

  .modal h3 {
    font-family: 'DM Serif Display', serif;
    font-size: 20px;
    color: var(--gold);
    margin-bottom: 6px;
  }

  .modal .quiz-hint {
    font-size: 13px;
    color: var(--cream-dim);
    margin-bottom: 16px;
  }

  .modal .quiz-q {
    font-size: 16px;
    color: var(--cream);
    line-height: 1.55;
    margin-bottom: 20px;
    font-weight: 500;
  }

  .modal .quiz-input {
    width: 100%;
    padding: 14px 16px;
    background: var(--bg);
    border: 1px solid var(--border);
    border-radius: 10px;
    color: var(--cream);
    font-family: 'DM Sans', sans-serif;
    font-size: 16px;
    text-align: center;
    outline: none;
    margin-bottom: 12px;
    transition: border-color 0.3s;
    min-height: 48px;
  }
  .modal .quiz-input:focus { border-color: var(--gold-dim); }

  .modal .quiz-submit {
    width: 100%;
    padding: 14px;
    background: linear-gradient(135deg, var(--gold-dim), var(--gold));
    border: none;
    border-radius: 10px;
    color: var(--bg);
    font-family: 'DM Sans', sans-serif;
    font-size: 15px;
    font-weight: 700;
    cursor: pointer;
    min-height: 48px;
  }
  .modal .quiz-submit:active { opacity: 0.9; }

  .modal .quiz-result {
    margin-top: 16px;
    font-size: 14px;
    line-height: 1.5;
    display: none;
    font-weight: 500;
  }
  .modal .quiz-result.wrong { color: var(--red); display: block; }
  .modal .quiz-result.busted { color: var(--gold); display: block; }

  .modal .modal-close {
    margin-top: 14px;
    padding: 10px 24px;
    background: none;
    border: 1px solid var(--border);
    border-radius: 8px;
    color: var(--cream-dim);
    font-family: 'DM Sans', sans-serif;
    font-size: 14px;
    cursor: pointer;
    min-height: 42px;
  }
  .modal .modal-close:active { opacity: 0.7; }

  /* â”€â”€â”€ ANIMATIONS â”€â”€â”€ */
  @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
  @keyframes fadeDown { from { opacity: 0; transform: translateY(-16px); } to { opacity: 1; transform: translateY(0); } }
  @keyframes fadeUp { from { opacity: 0; transform: translateY(16px); } to { opacity: 1; transform: translateY(0); } }
  @keyframes popIn { 0% { transform: scale(0.5); opacity: 0; } 50% { transform: scale(1.08); } 100% { transform: scale(1); opacity: 1; } }
  @keyframes shake { 0%,100% { transform: translateX(0); } 20% { transform: translateX(-6px); } 40% { transform: translateX(6px); } 60% { transform: translateX(-4px); } 80% { transform: translateX(4px); } }
  .shake { animation: shake 0.4s ease; }
</style>
</head>
<body>

<div class="ambient amb-1"></div>
<div class="ambient amb-2"></div>

<!-- LOGIN -->
<div class="login-screen" id="loginScreen">
  <div class="login-box">
    <span class="login-icon">ğŸ¥ƒ</span>
    <h1>Kokteyl Gecesi</h1>
    <p class="subtitle">Sana Ã¶zel ÅŸifreni gir, oylamaya katÄ±l</p>
    <input type="text" class="password-input" id="passInput" placeholder="Åifre" autocomplete="off" autocapitalize="characters" spellcheck="false">
    <button class="btn-gold" onclick="handleLogin()">GÄ°RÄ°Å YAP</button>
    <p class="login-error" id="loginError"></p>
  </div>
</div>

<!-- VOTE -->
<div class="vote-screen" id="voteScreen">
  <div class="page">
    <div class="header">
      <span class="header-icon">ğŸ¸</span>
      <div class="greeting-banner" id="greetingText"></div>
      <h1 class="title">Viski Gecesi MenÃ¼sÃ¼</h1>
      <p>Bu sefer viski bazlÄ± 5 kokteyl hazÄ±rladÄ±m. En beÄŸendiÄŸin 3 tanesini seÃ§!</p>
      <div class="rule-badges">
        <span class="rule-badge">ğŸ”’ Her kokteylde 2 sÃ¼rpriz malzeme var</span>
        <span class="hint-badge">ğŸ‘† SÃ¼rprizlere dokun, soruyu bil, malzemeyi Ã¶ÄŸren!</span>
      </div>
    </div>

    <div class="counter" id="counter"><span class="num" id="countNum">0</span> / 3 seÃ§ildi</div>
    <div id="cardList"></div>
    <div class="submit-wrap">
      <button class="submit-btn" id="submitBtn" onclick="handleSubmit()">OYUMU GÃ–NDER</button>
    </div>
  </div>
</div>

<!-- SUCCESS -->
<div class="success-screen" id="successScreen">
  <div>
    <span class="icon">ğŸ‰</span>
    <h1 class="title">Oyun Kaydedildi!</h1>
    <p>TeÅŸekkÃ¼rler, seÃ§imlerin iletildi.<br>Kokteyl gecesinde gÃ¶rÃ¼ÅŸÃ¼rÃ¼z!</p>
    <div class="chosen-list" id="chosenList"></div>
  </div>
</div>

<!-- QUIZ MODAL -->
<div class="modal-overlay" id="quizModal">
  <div class="modal">
    <h3>ğŸ”’ SÃ¼rpriz Kilidi</h3>
    <p class="quiz-hint">Soruyu doÄŸru cevapla, sÃ¼rpriz malzemeyi Ã¶ÄŸren</p>
    <p class="quiz-q" id="quizQuestion"></p>
    <input type="text" class="quiz-input" id="quizInput" placeholder="CevabÄ±nÄ± yaz..." autocomplete="off" inputmode="text">
    <button class="quiz-submit" onclick="checkQuiz()">CEVAPLA</button>
    <div class="quiz-result" id="quizResult"></div>
    <button class="modal-close" onclick="closeQuiz()">Kapat</button>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// âš™ï¸ EMAILJS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const EMAILJS_PUBLIC_KEY  = 'DDJeUgA08efhrrIPp';
const EMAILJS_SERVICE_ID  = 'service_vkb7jry';
const EMAILJS_TEMPLATE_ID = 'template_cohm3z2';

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ” ÅÄ°FRELER
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const PASSWORDS = {
  'ARAP':     { name: 'Uygur',   greeting: 'HoÅŸ geldin Uygur Bey, buyur iÃ§eri ğŸ©', admin: false },
  'TAPULU':   { name: 'Ufuk',    greeting: 'HoÅŸ geldin Ufuk Bey, seni bekliyorduk ğŸ¥‚', admin: false },
  'MDMA':     { name: 'A.H.T.T', greeting: 'HoÅŸ geldin A.H.T.T, bar sana aÃ§Ä±k ğŸ¸', admin: false },
  'MGAVM':    { name: 'MTK',     greeting: 'HoÅŸ geldin MTK, gecenin yÄ±ldÄ±zÄ± sensin âœ¨', admin: false },
  'NAMUSSUZ': { name: 'Patron',  greeting: 'HoÅŸ geldin Patron, sistem senin emrinde ğŸ”§', admin: true }
};

function getUsed() {
  try { return JSON.parse(localStorage.getItem('kg_used') || '[]'); }
  catch { return []; }
}
function setUsed(p) {
  const u = getUsed();
  if (!u.includes(p)) { u.push(p); localStorage.setItem('kg_used', JSON.stringify(u)); }
}

let currentVoter = '';
let currentPass = '';
let isAdmin = false;

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ¸ KOKTEYLler
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const BUSTED = 'Bravo, cidden Ã§ok iyi yapay zeka kullanÄ±yorsun. SÃ¼rpriz dediysek sÃ¼rpriz ğŸ¤–';

const cocktails = [
  {
    id: 'haysiyetsiz', name: 'Haysiyetsiz',
    vibe: 'DumanlÄ± Â· TatlÄ± Â· Otsu',
    visible: ['KÃ¶zlenmiÅŸ pÄ±rasa', 'Bal', 'Limon', 'Soda'],
    secrets: ['Armut', 'AdaÃ§ayÄ±'],
    garnish: 'KÃ¶zlenmiÅŸ pÄ±rasa halkasÄ± & armut dilimi ile servis edilir',
    questions: [
      { q: 'Fermat\'Ä±n Son Teoremi\'ni kanÄ±tlayan matematikÃ§inin soyadÄ± nedir?', a: 'wiles' },
      { q: 'Riemann Hipotezi hangi matematik dalÄ±yla ilgilidir: Cebir, Analiz, Topoloji?', a: 'analiz' }
    ]
  },
  {
    id: 'edepsiz', name: 'Edepsiz',
    vibe: 'BaharatlÄ± Â· EkÅŸi Â· Cesur',
    visible: ['KÃ¶zlenmiÅŸ kÄ±rmÄ±zÄ± biber', 'Bal', 'Limon', 'Soda'],
    secrets: ['Zencefil', 'Nar'],
    garnish: 'Biber dilimi & limon kabuÄŸu ile servis edilir',
    questions: [
      { q: 'PoincarÃ© VarsayÄ±mÄ±\'nÄ± kanÄ±tlayÄ±p Fields MadalyasÄ±\'nÄ± reddeden matematikÃ§inin soyadÄ±?', a: 'perelman' },
      { q: 'Hilbert\'in 1900\'de sunduÄŸu Ã¼nlÃ¼ Ã§Ã¶zÃ¼lmemiÅŸ problemler listesinde kaÃ§ problem vardÄ±?', a: '23' }
    ]
  },
  {
    id: 'yuzsuz', name: 'YÃ¼zsÃ¼z',
    vibe: 'KremamsÄ± Â· SÄ±cak Â· YoÄŸun',
    visible: ['Tahin', 'Bal', 'Limon'],
    secrets: ['Muz', 'TarÃ§Ä±n'],
    garnish: 'Tahin Ã§izgisi & bal damlasÄ± ile servis edilir',
    questions: [
      { q: 'GÃ¶del\'in Eksiklik Teoremi hangi alanda devrim yarattÄ±: Geometri, MantÄ±k, Ä°statistik?', a: 'mantÄ±k' },
      { q: 'Collatz VarsayÄ±mÄ±\'nda baÅŸlangÄ±Ã§ sayÄ±sÄ± tek ise ne yapÄ±lÄ±r: 3n+1 mi, 2n+1 mi?', a: '3n+1' }
    ]
  },
  {
    id: 'arsiz', name: 'ArsÄ±z',
    vibe: 'Toprak Â· EkÅŸi Â· DumanlÄ±',
    visible: ['Pancar', 'Portakal', 'Limon', 'Soda'],
    secrets: ['YakÄ±lmÄ±ÅŸ biberiye', 'AkÃ§aaÄŸaÃ§ ÅŸurubu'],
    garnish: 'Portakal dilimi & pancar ÅŸeridi ile servis edilir',
    questions: [
      { q: 'DÃ¶rt Renk Teoremi\'ne gÃ¶re herhangi bir harita en az kaÃ§ renkle boyanabilir?', a: '4' },
      { q: 'Cantor\'un Ã§aprazlama kanÄ±tÄ± neyin sayÄ±lamaz olduÄŸunu gÃ¶sterir: Rasyonel sayÄ±lar mÄ±, Reel sayÄ±lar mÄ±?', a: 'reel' }
    ]
  },
  {
    id: 'terbiyesiz', name: 'Terbiyesiz',
    vibe: 'KremamsÄ± Â· Taze Â· Meyveli',
    visible: ['Avokado', 'BÃ¶ÄŸÃ¼rtlen', 'Limon', 'Soda'],
    secrets: ['Nane', 'Bal'],
    garnish: 'BÃ¶ÄŸÃ¼rtlen & limon kabuÄŸu ile servis edilir',
    questions: [
      { q: 'P vs NP problemi hangi alanÄ±n en bÃ¼yÃ¼k aÃ§Ä±k sorusudur: Fizik, Bilgisayar Bilimi, Biyoloji?', a: 'bilgisayar' },
      { q: 'Nash Dengesi hangi alanla ilgilidir: Oyun Teorisi, Kaos Teorisi, KÃ¼me Teorisi?', a: 'oyun' }
    ]
  }
];

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// LOGIN
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const passInput = document.getElementById('passInput');
passInput.addEventListener('keydown', e => { if (e.key === 'Enter') handleLogin(); });

function handleLogin() {
  const val = passInput.value.trim().toUpperCase();
  const err = document.getElementById('loginError');

  if (!PASSWORDS[val]) {
    err.textContent = 'GeÃ§ersiz ÅŸifre';
    err.classList.add('show');
    passInput.classList.add('shake');
    setTimeout(() => passInput.classList.remove('shake'), 400);
    return;
  }

  const pw = PASSWORDS[val];

  if (!pw.admin && getUsed().includes(val)) {
    err.textContent = 'Bu ÅŸifre zaten kullanÄ±ldÄ±. Ã‡akallÄ±k mÄ± yapÄ±yorsun? ğŸ§';
    err.classList.add('show');
    passInput.classList.add('shake');
    setTimeout(() => passInput.classList.remove('shake'), 400);
    return;
  }

  currentVoter = pw.name;
  currentPass = val;
  isAdmin = pw.admin;
  document.getElementById('loginScreen').style.display = 'none';
  document.getElementById('voteScreen').style.display = 'block';
  document.getElementById('greetingText').textContent = pw.greeting;
  renderCards();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CARDS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let selected = new Set();
const MAX = 3;

function renderCards() {
  document.getElementById('cardList').innerHTML = cocktails.map(c => `
    <div class="card" id="card-${c.id}" onclick="toggle('${c.id}')">
      <div class="check"><svg viewBox="0 0 24 24"><polyline points="4 12 10 18 20 6"/></svg></div>
      <div class="card-name">${c.name}</div>
      <div class="card-vibe">${c.vibe}</div>
      <div class="ingredients">${c.visible.map(v => `<span class="ing-tag">${v}</span>`).join('')}</div>
      <div class="surprise-tags">
        <span class="surprise-tag" id="s-${c.id}-0" onclick="event.stopPropagation(); openQuiz('${c.id}', 0)">ğŸ”’ SÃ¼rpriz #1</span>
        <span class="surprise-tag" id="s-${c.id}-1" onclick="event.stopPropagation(); openQuiz('${c.id}', 1)">ğŸ”’ SÃ¼rpriz #2</span>
      </div>
      <div class="garnish">${c.garnish}</div>
    </div>
  `).join('');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ§® MATEMATÄ°K QUIZ
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let currentQuizCocktail = null;
let currentQuizIndex = null;

function openQuiz(cocktailId, surpriseIndex) {
  const tag = document.getElementById(`s-${cocktailId}-${surpriseIndex}`);
  if (tag.classList.contains('revealed')) return;

  const c = cocktails.find(x => x.id === cocktailId);
  currentQuizCocktail = cocktailId;
  currentQuizIndex = surpriseIndex;

  document.getElementById('quizQuestion').textContent = c.questions[surpriseIndex].q;
  document.getElementById('quizInput').value = '';
  const result = document.getElementById('quizResult');
  result.className = 'quiz-result';
  result.textContent = '';
  document.getElementById('quizModal').classList.add('show');
  setTimeout(() => document.getElementById('quizInput').focus(), 150);
}

function checkQuiz() {
  const c = cocktails.find(x => x.id === currentQuizCocktail);
  const q = c.questions[currentQuizIndex];
  const answer = document.getElementById('quizInput').value.trim().toLowerCase();
  const result = document.getElementById('quizResult');

  if (!answer) return;

  if (answer.includes(q.a.toLowerCase())) {
    result.textContent = BUSTED;
    result.className = 'quiz-result busted';
  } else {
    result.textContent = 'YanlÄ±ÅŸ cevap! SÃ¼rpriz malzeme gizli kalÄ±yor ğŸ¤·';
    result.className = 'quiz-result wrong';
  }
}

function closeQuiz() {
  document.getElementById('quizModal').classList.remove('show');
  currentQuizCocktail = null;
  currentQuizIndex = null;
}

document.getElementById('quizInput').addEventListener('keydown', e => { if (e.key === 'Enter') checkQuiz(); });

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SELECTION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function toggle(id) {
  if (selected.has(id)) selected.delete(id);
  else if (selected.size < MAX) selected.add(id);
  updateUI();
}

function updateUI() {
  const n = selected.size;
  document.getElementById('countNum').textContent = n;
  document.getElementById('counter').classList.toggle('done', n === MAX);
  cocktails.forEach(c => {
    const el = document.getElementById(`card-${c.id}`);
    const s = selected.has(c.id);
    el.classList.toggle('selected', s);
    el.classList.toggle('disabled', !s && n >= MAX);
  });
  document.getElementById('submitBtn').classList.toggle('active', n === MAX);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SUBMIT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function handleSubmit() {
  if (selected.size !== MAX) return;
  const btn = document.getElementById('submitBtn');
  btn.textContent = 'GÃ–NDERÄ°LÄ°YOR...';
  btn.classList.add('sending');

  const choices = [...selected].map(id => cocktails.find(c => c.id === id).name);
  const now = new Date().toLocaleString('tr-TR');

  try {
    emailjs.init(EMAILJS_PUBLIC_KEY);
    await emailjs.send(EMAILJS_SERVICE_ID, EMAILJS_TEMPLATE_ID, {
      voter: currentVoter,
      choices: choices.join(', '),
      time: now
    });
  } catch (e) {
    console.error('EmailJS error:', e);
  }

  if (!isAdmin) setUsed(currentPass);
  showSuccess(choices);
}

function showSuccess(choices) {
  document.getElementById('voteScreen').style.display = 'none';
  const ss = document.getElementById('successScreen');
  ss.style.display = 'flex';
  document.getElementById('chosenList').innerHTML = choices.map(n => `<div class="chosen-item">ğŸ¸ ${n}</div>`).join('');
}
</script>
</body>
</html>
